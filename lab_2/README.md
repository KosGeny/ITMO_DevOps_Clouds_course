# Отчёт по лабораторной работе №2

Выполнили: Генне Константин K3240 и Савченко Анастасия K3241

## Техническое задание

1. Написать “плохой” Dockerfile, в котором есть не менее трех “bad practices” по написанию докерфайлов
2. Написать “хороший” Dockerfile, в котором эти плохие практики исправлены
3. В Readme описать каждую из плохих практик в плохом докерфайле, почему она плохая и как в хорошем она была исправлена, как исправление повлияло на результат
4. В Readme описать 2 плохих практики по работе с контейнерами. ! Не по написанию докерфайлов, а о том, как даже используя хороший докерфайл можно накосячить именно в работе с контейнерами.

## Ход работы

"Плохой" Dockerfile:

```Dockerfile
FROM python:latest

ADD app.py .

CMD ["python", "./app.py"]
```

"Хороший" Dockerfile:

```Dockerfile
FROM python:3.8-slim

WORKDIR /app

COPY app.py .

CMD ["python", "./app.py"]
```

#### 1. Использование latest вместо конкретной версии

```Dockerfile
FROM python:latest
```
Тег `latest` указывает на последнюю доступную версию образа, что может привести к непредсказуемому поведению. Использование данного тега может негативно повлиять на работу контейнера в будущем, поскольку в базовый образ могут быть внесены изменения, что может привести к тому, что контейнер станет работать некорректно или в целом перестанет работать из-за несовместимости с новой версией.

```Dockerfile
FROM python 3.8-slim
```
Указав конкретную версию, мы можем быть уверены, что и через некоторое время всё будет работать так, как было задумано.

#### 2. Использование ADD в тех случаях, когда можно использовать COPY

```Dockerfile
ADD app.py .
```
Инструкция `ADD` помимо копирования локальных файлов и каталогов также автоматически распаковывает архивы и может обрабатывать URL-адреса.  Непонимание принципов работы ADD с архивами может привести к непреднамеренным последствиям. Загрузка внешних URL-адресов может привести к перехвату данных сторонним лицом и их изменению.

```Dockerfile
COPY app.py .
```
В данной ситуации нам не требуется этот расширенный функционал. Разработчики рекомендуют, в основном, использовать инструкцию `COPY`.

#### 3. Неиспользование инструкции WORKDIR

Не следует работать в корневой директории, чтобы избежать случайного изменения или удаления критически важных системных файлов и директорий.

```Dockerfile
WORKDIR /app
```

Инструкция `WORKDIR` задаёт рабочую папку приложения, позволяет явно указать место, где будет происходить работа. Все команды, такие как `RUN`, `COPY`, и `CMD` выполняются относительно установленной рабочей директории.

Установка рабочей директории с помощью `WORKDIR` помогает изолировать зависимости и файлы приложения от системных файлов.

Использовать `WORKDIR` не только полезно, но и является хорошим тоном, поскольку, в том числе, повышает уровень удобочитаемости.

### Плохие практики при работе с контейнерами

#### 1. Отсутствие ограничения использования ресурсов контейнерами

Важно ограничивать использование CPU, памяти и других ресурсов при запуске контейнеров. Это позволит оптимизировать совместную работу контейнеров, т. к. ни один контейнер не сможет монополизировать системные ресурсы, и предотвратить сильное влияние ресурсоёмких приложений.
Установить ограничения, например, можно при запуске контейнера с помощью флагов `-m` или `--memory=` на память и  `--cpus` на процессор.

#### 2. Хранение данных внутри контейнера

Не следует хранить данные, которые могут потребоваться при дальнейшей работе, внутри контейнеров. Это связано с тем, что контейнер в ходе своего жизненного цикла может быть остановлен, уничтожен или заменён, что приведёт к потере данных.

## Вывод

В ходе выполнения лабораторной работы мы познакомились с новой для себя технологией - Docker и попрактиковались в написании Dockerfiles. Удалось разобрать некоторые антипаттерны или bad practices как при создании Dockerfile, так и при непосредственной работе с контейнерами. Было выполнено техническое задание. Работать было интересно)
